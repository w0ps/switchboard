<template name="needs">
  {{#if isAllowed 'separate windows'}}
    {{> needlist}}
  {{else}}
    <aside id="needlist">{{> needlist}}</aside>
    <section id="openchats">{{> chatcollection}}</section>
  {{/if}}
</template>

<template name="needlist">
  {{#if isAllowed 'post needs'}}
    <input class="inverted" name="need" placeholder="what is your need" />
    {{#if isAllowed 'post resources'}}
      <button class="resource">R</button>
    {{/if}}
  {{/if}}
  <ul class="needs">
    {{#each getLooseResources}}
      <li class="free resource">
        {{> resource this}}
      </li>
    {{/each}}
    {{#each needs}}
      {{> need}}
    {{/each}}
  </ul>
</template>

<template name="need">
  <li class="need">
    {{#if isAllowed 'post resources'}}
      <button class="resource">R</button>
    {{/if}}
    {{{getAvatar createdBy}}}
    <span class="name">{{userIdToUserName createdBy}}</span>
    <!-- JF change CSS based on Need state        -->
    <span class="need-title-state-{{state}}">
    <!-- /JF -->
        <span class="timecode">{{formatTime created}}</span>    
        <span {{contenteditability}}>{{title}}</span>        
    </span>
    
  </li>
  {{#if getResources _id}}
    {{#each getResources _id}}
      <li class="resource">
        {{> resource this}}
      </li>
    {{/each}}
  {{/if}}
</template>

<template name="resource">
  {{{getAvatar createdBy}}}<span {{contenteditability}}>{{value}}</span>
</template>

<template name="chatcollection">

                                    <!-- JF 2016-04-11 was 300px -->
  <div style="width: calc( {{conversations.length}} * 300px ); height: 100%; position: relative">
    {{#each conversations}}
      <div class="conversation">
        <button class="close">x</button>
        {{> chat this}}
      </div>
    {{/each}}
  </div>
</template>